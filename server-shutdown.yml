- hosts: all
  vars_prompt:
    - name: shutdown_delay
      prompt: |-
        Enter the delay before shutdown (in second, must be above 60). Leave empty to shutdown immediately.
        delay
      private: no
  tasks:
    - name: Ensuring apps are stopped
      ansible.builtin.include_role:
        name: apps-action
      vars:
        apps_state: absent

    - community.general.shutdown:
        delay: "{{ shutdown_delay | default(0, true) }}"
      become: yes
