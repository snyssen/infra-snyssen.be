- name: Creating folders
  ansible.builtin.file:
    path: "{{ item.path }}"
    state: directory
  loop:
    - path: "/mnt/storage/pictures"
    - path: "/mnt/storage/photoprism/mariadb"
    - path: "/mnt/storage/photoprism/import"
    - path: "/mnt/storage/photoprism/photoprism"
    - path: "/mnt/storage/backups/photoprism"

- ansible.builtin.include_role:
    name: container-deploy
  vars:
    container_name: "photoprism"

- name: Adds cron job to backup Photoprism
  become: yes
  ansible.builtin.cron:
    name: photoprism_backup
    minute: "18"
    hour: "02"
    user: root
    job: "docker exec photoprism photoprism backup -i -f"
    state: present
