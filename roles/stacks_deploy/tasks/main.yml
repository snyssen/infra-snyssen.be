- name: Permitting traffic through http
  become: yes
  ansible.posix.firewalld:
    service: http
    permanent: yes
    state: enabled
- name: Permitting traffic through https
  become: yes
  ansible.posix.firewalld:
    service: https
    permanent: yes
    state: enabled

- name: Creating web network
  ansible.builtin.docker_network:
    name: web
- name: Creating monitoring network
  ansible.builtin.docker_network:
    name: monitoring

- ansible.builtin.include_role:
    name: container_backbone
  when: "stacks_deploy_list is not defined or 'backbone' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_ddns
  when: "stacks_deploy_list is not defined or 'ddns' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_streaming
  when: "stacks_deploy_list is not defined or 'streaming' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_piped
  when: "stacks_deploy_list is not defined or 'piped' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_nextcloud
  when: "stacks_deploy_list is not defined or 'nextcloud' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_photoprism
  when: "stacks_deploy_list is not defined or 'photoprism' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_recipes
  when: "stacks_deploy_list is not defined or 'recipes' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_speedtest
  when: "stacks_deploy_list is not defined or 'speedtest' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_git
  when: "stacks_deploy_list is not defined or 'git' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_cicd
  when: "stacks_deploy_list is not defined or 'cicd' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_minecraft
  when: "stacks_deploy_list is not defined or 'minecraft' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_dashboard
  when: "stacks_deploy_list is not defined or 'dashboard' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_snyssen_be
  when: "stacks_deploy_list is not defined or 'snyssen_be' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_wiki
  when: "stacks_deploy_list is not defined or 'wiki' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_foundryvtt
  when: "stacks_deploy_list is not defined or 'foundryvtt' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_monitoring
  when: "stacks_deploy_list is not defined or 'monitoring' in stacks_deploy_list"
- ansible.builtin.include_role:
    name: container_scrutiny
  when: "stacks_deploy_list is not defined or 'scrutiny' in stacks_deploy_list"

- ansible.builtin.include_role:
    name: container_restic
  when: "stacks_deploy_list is not defined or 'restic' in stacks_deploy_list"
