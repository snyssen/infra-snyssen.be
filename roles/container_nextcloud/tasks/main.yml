- name: Creating folders
  ansible.builtin.file:
    path: "{{ item }}"
    state: directory
  with_items:
    # nextcloud
    - /mnt/storage/nextcloud

- ansible.builtin.include_role:
    name: snyssen.compose_deploy
  vars:
    stack_name: "nextcloud"

- name: Adds cron job for Nextcloud
  become: yes
  ansible.builtin.cron:
    name: Nextcloud
    minute: "*/5"
    user: root
    job: "docker exec -u www-data nextcloud php cron.php && curl -fsS -m 10 --retry 5 -o /dev/null https://hc-ping.com/{{ nextcloud__healthcheck_id }}"
    state: present
