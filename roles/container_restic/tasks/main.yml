- name: Creating folders
  ansible.builtin.file:
    path: "{{ docker_compose_directory }}/restic/hooks"
    state: directory

- name: Deploying pre- and post-backup scripts
  ansible.builtin.copy:
    src: "{{ item }}"
    dest: "{{ docker_compose_directory }}/restic/hooks/{{ item }}"
    mode: "770"
  with_items:
    - pre-backup.sh
    - post-backup.sh

- ansible.builtin.set_fact:
    backups__volumes_local: "{{ backups__volumes_common + backups__volumes_local_only }}"
    backups__volumes_remote: "{{ backups__volumes_common + backups__volumes_remote_only }}"

- ansible.builtin.include_role:
    name: snyssen.compose_deploy
  vars:
    container_name: "restic"
